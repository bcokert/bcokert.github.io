<!DOCTYPE html>
<html lang="default">
    
<head>
    <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="BrandonOkert.com">
    <title>Testing in React - BrandonOkert.com</title>
    <meta name="author" content="Brandon Okert">
    <meta name="description" content="BrandonOkert.com">
    
    
    <meta name="description" content="Having recently been tasked with bringing our JS test coverage in React to &amp;gt;85%, I was surprised to find that there are scant resources for actually testing React components thoroughly. There are a">
<meta property="og:type" content="blog">
<meta property="og:title" content="Testing in React">
<meta property="og:url" content="http://brandonokert.com/2015/08/04/TestingInReact/index.html">
<meta property="og:site_name" content="BrandonOkert.com">
<meta property="og:description" content="Having recently been tasked with bringing our JS test coverage in React to &amp;gt;85%, I was surprised to find that there are scant resources for actually testing React components thoroughly. There are a">
<meta property="og:updated_time" content="2016-01-31T16:06:56.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Testing in React">
<meta name="twitter:description" content="Having recently been tasked with bringing our JS test coverage in React to &amp;gt;85%, I was surprised to find that there are scant resources for actually testing React components thoroughly. There are a">
<meta name="twitter:creator" content="@BrandonOkert">
    
    
    
        <meta property="og:image" content="http://www.gravatar.com/avatar/1796d3ceead403d9616a2093bc42ec18?s=640"/>
    
    
        <meta property="og:image" content="/2015/08/04/TestingInReact/thumbnail.png"/>
        <meta class="swiftype" name="image" data-type="enum" content="http://brandonokert.com/2015/08/04/TestingInReact/thumbnail.png" />
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style.min.css" type="text/css">
    <link rel="stylesheet" href="/css-custom/style.css" type="text/css">
    <!--STYLES END-->
    
    <script type="text/javascript">
        var _gaq = _gaq || [];
        _gaq.push(['_setAccount', 'UA-66027344-1']);
        _gaq.push(['_trackPageview']);
        (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
        })();
    </script>

</head>

    <body>
        <div id="blog">
            <header id="header" data-behavior="1">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <h1 class="header-title">
        <a class="header-title-link" href="/ ">BrandonOkert.com</a>
    </h1>
    
        
            <a  class="header-right-icon st-search-show-outputs"
                href="/#search">
        
                <i class="fa fa-lg fa-search"></i>
            </a>
    
</header>
            <nav id="sidebar" data-behavior="1">
    
    <div class="sidebar-profile">
        <a href="/#about">
            
            <img class="sidebar-profile-picture" src="http://www.gravatar.com/avatar/1796d3ceead403d9616a2093bc42ec18?s=90"/>
            
        </a>
        <span class="sidebar-profile-name">Brandon Okert</span>
    </div>
    
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/ 
                    ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-home"></i>
                    <span class="sidebar-button-desc">Home</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-tags
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-tags"></i>
                    <span class="sidebar-button-desc">Tags</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/all-archives
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-archive"></i>
                    <span class="sidebar-button-desc">Archives</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link "
                    href="/#about
                            ">
            
                    <i class="sidebar-button-icon fa fa-lg fa-question"></i>
                    <span class="sidebar-button-desc">About me</span>
                </a>
        </li>
        
    </ul>
    
    <ul class="sidebar-buttons">
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link " href="https://github.com/bcokert" target="_blank">
            
                    <i class="sidebar-button-icon fa fa-lg fa-github"></i>
                    <span class="sidebar-button-desc">GitHub</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link " href="https://twitter.com/BrandonOkert" target="_blank">
            
                    <i class="sidebar-button-icon fa fa-lg fa-twitter"></i>
                    <span class="sidebar-button-desc">Twitter</span>
                </a>
        </li>
        
        <li class="sidebar-button">
            
                <a  class="sidebar-button-link " href="https://www.linkedin.com/pub/brandon-okert/32/aa6/850" target="_blank">
            
                    <i class="sidebar-button-icon fa fa-lg fa-linkedin"></i>
                    <span class="sidebar-button-desc">Linked In</span>
                </a>
        </li>
        
    </ul>
    
</nav>
            <div id="main" data-behavior="1">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
        <div class="post-header main-content-wrap">
    
        <h1 class="post-title" itemprop="headline">Testing in React</h1>
    
    <div class="post-meta">
    <time  itemprop="datePublished" content="Tue Aug 04 2015 16:00:00 GMT-0700">
        Aug 04, 2015
    </time>
    
</div>
</div>
    
    <div class="post-content markdown main-content-wrap" itemprop="articleBody">
        
            <p>Having recently been tasked with bringing our JS test coverage in React to &gt;85%, I was surprised to find that there are scant resources for actually testing React components thoroughly. There are a few Test Utilities and getting started guides, but few examples to draw from for for in depth coverage. What do I do when I need to test a change in state resulting from a sequence of user actions? How can I verify a callback occurs at the correct time? How can I create effective mocks without drastically changing my architecture?</p>
<p>Through building up our own coverage, I’ve collected several such scenarios and gotchas that one is likely to encounter.</p>
<h1 id="table-of-contents">Contents</h1><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Scenarios"><span class="toc-text">Scenarios</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Component_Renders_with_the_Correct_DOM"><span class="toc-text">Verify Component Renders with the Correct DOM</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Component_Renders_its_Child_Components"><span class="toc-text">Verify Component Renders its Child Components</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Component_has_X_Children"><span class="toc-text">Verify Component has X Children</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Component_Passes_the_Correct_Props_to_its_Child"><span class="toc-text">Verify Component Passes the Correct Props to its Child</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Components_Callback_is_Called_with_the_Correct_Params"><span class="toc-text">Verify Components Callback is Called with the Correct Params</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Components_Callback_is_Not_Called"><span class="toc-text">Verify Components Callback is Not Called</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Components_Callback_is_Called_within_a_Specific_Time-Window"><span class="toc-text">Verify Components Callback is Called within a Specific Time-Window</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Components_State_is_Correct_after_a_Click"><span class="toc-text">Verify Components State is Correct after a Click</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Components_State_is_Correct_after_Typing"><span class="toc-text">Verify Components State is Correct after Typing</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Verify_Components_State_is_Correct_after_a_Sequence_of_Events"><span class="toc-text">Verify Components State is Correct after a Sequence of Events</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Utility_Patterns"><span class="toc-text">Utility Patterns</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Then"><span class="toc-text">Then</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WaitFor"><span class="toc-text">WaitFor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WithMocksBeforeEach"><span class="toc-text">WithMocksBeforeEach</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#WithMocks"><span class="toc-text">WithMocks</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gotchas"><span class="toc-text">Gotchas</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#You_Cannot_Check_State/Render_or_Simulate_Right_After_Simulating_an_Event"><span class="toc-text">You Cannot Check State/Render or Simulate Right After Simulating an Event</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#You_Cannot_Simulate_Events_in_Series_Without_Re-Finding_DOM_Components"><span class="toc-text">You Cannot Simulate Events in Series Without Re-Finding DOM Components</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#TestUtils-mockComponent_wont_create_basic_mocks"><span class="toc-text">TestUtils.mockComponent wont create basic mocks</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Expectations_won’t_print_inside_asynchronous_tests"><span class="toc-text">Expectations won’t print inside asynchronous tests</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mocked_dependencies_must_be_searched_for_my_their_mock_class"><span class="toc-text">Mocked dependencies must be searched for my their mock class</span></a></li></ol></li></ol>
<h1 id="Scenarios">Scenarios</h1><p>The code examples are all written in the React Transpilers subset of ES6, and in Jasmine/Karma style. However, any toolset that allows manual control of test completion (for asynchronous testing) should be fine. </p>
<p>In addition, many scenarios make use of Test Utilities. These will be referred to by name in the “Utility Patterns” heading of each scenario.</p>
<h2 id="Verify_Component_Renders_with_the_Correct_DOM">Verify Component Renders with the Correct DOM</h2><p>Utility Patterns: None</p>
<figure class="highlight javascript"><figcaption><span>my-component.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">var</span> children = <span class="keyword">this</span>.props.children.map((child) =&gt; &#123;</span><br><span class="line">      <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="title">li</span> <span class="attribute">className</span>=<span class="value">'child'</span>&gt;</span>&#123;child.sex === 'm' ? 'Son: ' : 'Daughter: '&#125; Name: &#123;child.name&#125; (&#123;child.age&#125;)<span class="tag">&lt;/<span class="title">li</span>&gt;</span>)</span>;</span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="xml"><span class="tag">&lt;<span class="title">div</span> <span class="attribute">className</span>=<span class="value">'container -large'</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="title">ul</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="title">li</span>&gt;</span>Name: &#123;this.props.name&#125;<span class="tag">&lt;/<span class="title">li</span>&gt;</span></span><br><span class="line">          &#123;children&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="title">ul</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line">    )</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> TestUtils = <span class="built_in">require</span>(<span class="string">'react/lib/ReactTestUtils'</span>);</span><br><span class="line"><span class="keyword">var</span> MyComponent = <span class="built_in">require</span>(<span class="string">'src/components/my-component'</span>);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'MyComponent'</span>, () =&gt; &#123;</span><br><span class="line">  it(<span class="string">'should render with the correct DOM'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> children = [</span><br><span class="line">      &#123;name: <span class="string">"Billy"</span>, age: <span class="number">4</span>, sex: <span class="string">'m'</span>&#125;,</span><br><span class="line">      &#123;name: <span class="string">"Sally"</span>, age: <span class="number">6</span>, sex: <span class="string">'f'</span>&#125;,</span><br><span class="line">    ];</span><br><span class="line">    <span class="keyword">var</span> myComponent = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">MyComponent</span> <span class="attribute">children</span>=/&gt;</span>)</span>;</span><br><span class="line">    <span class="keyword">var</span> renderedDOM = () =&gt; React.findDOMNode(myComponent);</span><br><span class="line">    </span><br><span class="line">    expect(renderedDOM.tagName).toBe(<span class="string">'div'</span>);</span><br><span class="line">    expect(renderedDOM.classList).toEqual([<span class="string">'container'</span>, <span class="string">'-large'</span>]);</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">      </span><br><span class="line">    <span class="keyword">var</span> children = renderedDOM.querySelectorAll(<span class="string">'li.child'</span>);</span><br><span class="line">    expect(children.length).toBe(<span class="number">2</span>);</span><br><span class="line">    expect(children[<span class="number">0</span>]).toEqual(&#123;name: <span class="string">"Billy"</span>, age: <span class="number">4</span>, sex: <span class="string">'m'</span>&#125;);</span><br><span class="line">    <span class="comment">//...</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Verify_Component_Renders_its_Child_Components">Verify Component Renders its Child Components</h2><p>Utility Patterns: WithMocks</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should be rendered with an Avatar as a child'</span>, () =&gt; &#123;</span><br><span class="line">  profile = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">Profile</span> /&gt;</span>)</span>;</span><br><span class="line">  <span class="keyword">var</span> child = ReactTestUtils.findRenderedComponentWithType(profile, Avatar);</span><br><span class="line">  expect(ReactTestUtils.isCompositeComponentWithType(child, Avatar)).toBe(<span class="literal">true</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>If you have mocked the child components, then you need to search for the mocked classes:<br><figure class="highlight javascript"><figcaption><span>my-component-mocked-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MockAvatar</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;...&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">it(<span class="string">'should be rendered with an Avatar as a child'</span>, () =&gt; &#123;</span><br><span class="line">  withMocks(Profile, &#123;</span><br><span class="line">    Avatar: MockAvatar</span><br><span class="line">  &#125;, () =&gt; &#123;</span><br><span class="line">    profile = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">Profile</span> /&gt;</span>)</span>;</span><br><span class="line">    <span class="keyword">var</span> child = ReactTestUtils.findRenderedComponentWithType(profile, MockAvatar);</span><br><span class="line">    expect(ReactTestUtils.isCompositeComponentWithType(child, Avatar)).toBe(<span class="literal">true</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="Verify_Component_has_X_Children">Verify Component has X Children</h2><p>Utility Patterns: None</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should be rendered with several child Profiles'</span>, () =&gt; &#123;</span><br><span class="line">  profileList = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">ProfileList</span> /&gt;</span>)</span>;</span><br><span class="line">  <span class="keyword">var</span> children = ReactTestUtils.scryRenderedComponentsWithType(profileList, Profile);</span><br><span class="line">  expect(children.length).toBe(<span class="number">5</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Verify_Component_Passes_the_Correct_Props_to_its_Child">Verify Component Passes the Correct Props to its Child</h2><p>Utility Patterns: None</p>
<p>Props are persistent for the current ‘render’ of a component, and thus can be easily referred to at any point in a components lifetime.</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should pass the correct value into its child Avatar'</span>, () =&gt; &#123;</span><br><span class="line">  profile = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">Profile</span> /&gt;</span>)</span>;</span><br><span class="line">  <span class="keyword">var</span> avatar = ReactTestUtils.findRenderedComponentWithType(profile, Avatar);</span><br><span class="line">  expect(avatar.props.url).toBe(profile.state.mainAvatarUrl);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Verify_Components_Callback_is_Called_with_the_Correct_Params">Verify Components Callback is Called with the Correct Params</h2><p>Utility Patterns: WaitFor</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should call the onClose callback and pass in the accountLists id when close is clicked'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> wasCallbackCalledCorrectly = <span class="literal">false</span>;</span><br><span class="line">  accountList = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountList</span> <span class="attribute">id</span>=<span class="value">&#123;42&#125;</span> <span class="attribute">onClose</span>=<span class="value">&#123;(id)</span> =&gt;</span> &#123;</span><br><span class="line">    wasCallbackCalledCorrectly = id === 42;</span><br><span class="line">  &#125;&#125; /&gt;)</span>;</span><br><span class="line">  </span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode(accountList.refs.closeButton));</span><br><span class="line">  waitFor(() =&gt; wasCallbackCalledCorrectly, <span class="string">'The onClose callback was not called when close was clicked'</span>, done);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Verify_Components_Callback_is_Not_Called">Verify Components Callback is Not Called</h2><p>Utility Patterns: Then</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should not call the onClose callback when close is clicked but there is a warning'</span>, (done) =&gt; &#123;</span><br><span class="line">  accountList = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountList</span></span><br><span class="line">    <span class="attribute">initialWarning</span>=<span class="value">'No profiles found. Please add at least one profile'</span></span><br><span class="line">    <span class="attribute">onClose</span>=<span class="value">&#123;()</span> =&gt;</span> &#123;</span><br><span class="line">      fail('The close callback was called while the account list contains a warning');</span><br><span class="line">      done(); // ensure we don't waste time waiting for the test to time out</span><br><span class="line">    &#125;&#125;</span><br><span class="line">  /&gt;)</span>;</span><br><span class="line">  </span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode(accountList.refs.closeButton));</span><br><span class="line">  then(() =&gt; done(), <span class="number">100</span>); <span class="comment">// give the component 100ms to fail, then assume it hasn't called it</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Verify_Components_Callback_is_Called_within_a_Specific_Time-Window">Verify Components Callback is Called within a Specific Time-Window</h2><p>Utility Patterns: WaitFor, Then</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Perhaps you want there to be a visual lag, so a process should take between x and y seconds #contrivedExample</span></span><br><span class="line">it(<span class="string">'should call the onDataReceived callback between 1 and 2 seconds of clicking the refresh button'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> wasCallbackCalled = <span class="literal">false</span>;</span><br><span class="line">  accountList = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountList</span> <span class="attribute">onDataReceived</span>=<span class="value">&#123;()</span> =&gt;</span> &#123;</span><br><span class="line">    wasCallbackCalled = true;</span><br><span class="line">  &#125;&#125; /&gt;)</span>;</span><br><span class="line">  </span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode(accountList.refs.refreshButton));</span><br><span class="line">  then(() =&gt; &#123;</span><br><span class="line">    expect(wasCallbackCalled).toBe(<span class="literal">false</span>);</span><br><span class="line">    then(() =&gt; &#123;</span><br><span class="line">      waitFor(() =&gt; wasCallbackCalled, <span class="string">'The onDataReceived callback was not called soon enough'</span>, done, <span class="number">1025</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, <span class="number">975</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Verify_Components_State_is_Correct_after_a_Click">Verify Components State is Correct after a Click</h2><p>Utility Patterns: Then, WaitFor</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should store the selected Account when one is clicked'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> accounts = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>].map(() =&gt; createTestAccountData());</span><br><span class="line">  <span class="keyword">var</span> accountList = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountList</span> <span class="attribute">accounts</span>=<span class="value">&#123;accounts&#125;</span> /&gt;</span>)</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// unlike re-rendering after a setState, renderIntoDocument will block until the component is rendered, so we can use it right away</span></span><br><span class="line">  <span class="keyword">var</span> accountToClick = TestUtils.scryRenderedComponentsWithType(accountList, Account)[<span class="number">1</span>];</span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode());</span><br><span class="line">  </span><br><span class="line">  then(() =&gt; &#123;</span><br><span class="line">    expect(accountList.state.selectedAccounts).toEqual([accounts[<span class="number">1</span>]);</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//OR</span></span><br><span class="line">  </span><br><span class="line">  waitFor(</span><br><span class="line">    () =&gt; accountList.state.selectedAccounts.length === <span class="number">1</span> &amp;&amp; accountList.state.selectedAccounts[<span class="number">0</span>] === accounts[<span class="number">1</span>],</span><br><span class="line">    <span class="string">'The Account was not selected after clicking it'</span>,</span><br><span class="line">    done</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="Verify_Components_State_is_Correct_after_Typing">Verify Components State is Correct after Typing</h2><p>Utility Patterns: WaitFor<br><figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should change the search query state after the user types in a name'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> accountList = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountList</span> <span class="attribute">accounts</span>=<span class="value">&#123;accounts&#125;</span> /&gt;</span>)</span>;</span><br><span class="line">  <span class="keyword">var</span> searchBoxNode = React.findDOMNode(accountList.refs.searchBoxInput);</span><br><span class="line">  </span><br><span class="line">  searchBoxNode.value = <span class="string">'Smitty Johnson'</span>;</span><br><span class="line">  ReactTestUtils.Simulate.change(searchBoxNode);</span><br><span class="line">  </span><br><span class="line">  waitFor(</span><br><span class="line">    () =&gt; accountlist.state.searchString === <span class="string">'Smitty Johnson'</span>,</span><br><span class="line">    <span class="string">'The search query was not updated after entering in a search string'</span>,</span><br><span class="line">    done</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<h2 id="Verify_Components_State_is_Correct_after_a_Sequence_of_Events">Verify Components State is Correct after a Sequence of Events</h2><p>Utility Patterns: Then</p>
<figure class="highlight javascript"><figcaption><span>my-component-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should de-select any accounts when I select an account group'</span>, (done) =&gt; &#123;</span><br><span class="line">  accountSelector = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountSelector</span> <span class="attribute">accounts</span>=<span class="value">&#123;[...]&#125;</span> <span class="attribute">accountGroups</span>=<span class="value">&#123;[...]&#125;</span> /&gt;</span>)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> accounts;</span><br><span class="line">  </span><br><span class="line">  accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">1</span>]);</span><br><span class="line">  then(() =&gt; &#123;</span><br><span class="line">    accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">    TestUtils.Simulate.click(accounts[<span class="number">2</span>]);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">    TestUtils.Simulate.click(accounts[<span class="number">4</span>]);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> accountGroup = TestUtils.findRenderedComponentWithType(accountSelector, AccountGroup);</span><br><span class="line">    TestUtils.Simulate.click(accountGroup);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">0</span>);</span><br><span class="line">    done();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="Utility_Patterns">Utility Patterns</h1><p>These patterns can make your life a lot easier, and make your tests cleaner to boot. I hesitate to call them libraries as they will likely have to be tuned to your specific scenario, and there are still edge cases that are not fully handled here. But by using them as building blocks, you should be able to extrapolate to solve various problems you might encounter.</p>
<h2 id="Then">Then</h2><p>The Then pattern is good for sequencing of events in the event loop. Most things in React (changing this.state after a setState(), rendering after a setState) are queued immediately, so simply ensuring things run in order can make them easy to test.<br>We can use expect(…) within Then’s without any surprises.<br><figure class="highlight javascript"><figcaption><span>then.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> then = <span class="function"><span class="keyword">function</span> (<span class="params">callback, timeout</span>) </span>&#123;</span><br><span class="line">  setTimeout(callback, timeout &gt; <span class="number">0</span> ? timeout : <span class="number">0</span>);</span><br><span class="line">  <span class="keyword">return</span> &#123;then: then&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = then;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><figcaption><span>then-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> then = <span class="built_in">require</span>(<span class="string">'lib/then'</span>);</span><br><span class="line"></span><br><span class="line">it(<span class="string">'should ...'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> component = ...;</span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode(component));</span><br><span class="line">  then(() =&gt; &#123;</span><br><span class="line">    TestUtils.Simulate.click(React.findDOMNode(component));</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    <span class="comment">// we gave this one an extra 100 ms, so we need to nest further thens to ensure they run in order</span></span><br><span class="line">    TestUtils.Simulate.click(React.findDOMNode(component));</span><br><span class="line">    then(() =&gt; &#123;</span><br><span class="line">      expect(...);</span><br><span class="line">      done();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;, <span class="number">100</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="WaitFor">WaitFor</h2><p>The WaitFor pattern is an extension of the then pattern, but instead of always doing something after a timeout, it waits for a condition to be true. This is useful primarily for asynchronous callbacks.<br><figure class="highlight javascript"><figcaption><span>wait-for.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> waitsInProgress = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> waitFor = (test, message, done, timeLeft) =&gt; &#123;</span><br><span class="line">  timeLeft = timeLeft === <span class="literal">undefined</span> ? <span class="number">100</span> : timeLeft;</span><br><span class="line">  waitsInProgress.push(setTimeout(() =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (timeLeft &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">      fail(message);</span><br><span class="line">      done();</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (test()) &#123;</span><br><span class="line">      done();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      waitFor(test, message, done, timeLeft - <span class="number">10</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, <span class="number">10</span>));</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">waitFor.clear = () =&gt; waitsInProgress.map(clearTimeout); <span class="comment">//optionally call this in the beforeEach to ensure rogue tests are not still waiting</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = waitFor;</span><br></pre></td></tr></table></figure></p>
<p>We manually call fail within the waitFor, since asynchronous callbacks will not display the output of an expect upon failure.<br>In jasmine, if you want to wait for longer than 5 seconds (not recommended for unit tests) you need to set the max timeout in the last argument of your ‘it’ function.</p>
<figure class="highlight javascript"><figcaption><span>wait-for-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> waitFor = <span class="built_in">require</span>(<span class="string">'lib/waitFor'</span>);</span><br><span class="line"></span><br><span class="line">it(<span class="string">'should ...'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> component = ...;</span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode(component));</span><br><span class="line">  waitFor(</span><br><span class="line">    () =&gt; component.state.isSelected,</span><br><span class="line">    <span class="string">'The component was not selected after clicking it'</span>,</span><br><span class="line">    done</span><br><span class="line">  );</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">it(<span class="string">'should wait for a long process'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> component = ...;</span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode(component));</span><br><span class="line">  waitFor(</span><br><span class="line">    () =&gt; component.state.ajaxResult,</span><br><span class="line">    <span class="string">'The component did not store the ajax response after clicking it and waiting 10 seconds'</span>,</span><br><span class="line">    done,</span><br><span class="line">    <span class="number">10000</span></span><br><span class="line">  );</span><br><span class="line">&#125;, <span class="number">10500</span>);</span><br></pre></td></tr></table></figure>
<h2 id="WithMocksBeforeEach">WithMocksBeforeEach</h2><p>This is a useful pattern to use along with a rewired component and some mocks. Simply specify that for all of the following tests, the dependencies of the component are to be replaced by the given mocks. Great for mocking things like ajaxServices.<br>Kreds to <a href="https://twitter.com/theasta" target="_blank" rel="external">Alex Boissiére</a> for the original implementation.</p>
<figure class="highlight javascript"><figcaption><span>with-mocks-before-each.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> withMocksBeforeEach = <span class="function"><span class="keyword">function</span> <span class="title">withMocksBeforeEach</span>(<span class="params">rewiredModule, varValues</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> rewiredReverts = [];</span><br><span class="line"></span><br><span class="line">  beforeEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> key, value, revert;</span><br><span class="line">    <span class="keyword">for</span> (key <span class="keyword">in</span> varValues) &#123;</span><br><span class="line">      <span class="keyword">if</span> (varValues.hasOwnProperty(key)) &#123;</span><br><span class="line">        value = varValues[key];</span><br><span class="line">        revert = rewiredModule.__set__(key, value);</span><br><span class="line">        rewiredReverts.push(revert);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  afterEach(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    rewiredReverts.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">revert</span>) </span>&#123;</span><br><span class="line">      revert();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> withMocksBeforeEach;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = withMocksBeforeEach;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>with-mocks-before-each-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> withMocksBeforeEach = <span class="built_in">require</span>(<span class="string">'lib/withMocksBeforeEach'</span>);</span><br><span class="line"><span class="keyword">var</span> rewire = <span class="built_in">require</span>(<span class="string">'rewire'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> LatestArticleButton = rewire(<span class="string">'src/components/latest-article-button'</span>);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'The get latest article button'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> mockAjaxRequest = (url, callback) =&gt; callback(&#123;success: <span class="literal">true</span>, content: <span class="string">""</span>&#125;);</span><br><span class="line">  <span class="keyword">var</span> mockDatabase = &#123;select: (table, command) =&gt; [], createTable: () =&gt; <span class="literal">null</span>&#125;;</span><br><span class="line">  </span><br><span class="line">  withMocksBeforeEach(LatestArticleButton, &#123;</span><br><span class="line">    ajaxRequest: mockAjaxRequest,</span><br><span class="line">    factsDatabase: mockDatabase</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  it(<span class="string">'should render a sorry message if an article is returned successfully but is empty'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> component = React.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">LatestArticleButton</span> /&gt;</span>)</span>;</span><br><span class="line">    TestUtils.Simulate.click(component.findDOMElement); <span class="comment">// will eventually make an ajaxRequest</span></span><br><span class="line">    waitFor(() =&gt; component.state.overlayMessage === <span class="string">'That article is no longer available'</span>, <span class="string">'The correct error was not displayed'</span>, done);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="WithMocks">WithMocks</h2><p>This is similar to the withMocksBeforeEach pattern, but can be applied to individual tests. Good for when some mocks are shared, and some are particular to only a single test.</p>
<figure class="highlight javascript"><figcaption><span>with-mocks.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> withMocks = <span class="function"><span class="keyword">function</span> <span class="title">withMocks</span>(<span class="params">dut, mockedDependencies, test</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> rewiredReverts = [];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> key, value, revert;</span><br><span class="line">  <span class="keyword">for</span> (key <span class="keyword">in</span> mockedDependencies) &#123;</span><br><span class="line">    <span class="keyword">if</span> (mockedDependencies.hasOwnProperty(key)) &#123; </span><br><span class="line">      value = mockedDependencies[key];</span><br><span class="line">      revert = dut.__set__(key, value);</span><br><span class="line">      rewiredReverts.push(revert);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> testThenCleanup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    test();</span><br><span class="line">    rewiredReverts.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">revertToCall</span>) </span>&#123;</span><br><span class="line">      revertToCall();</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  testThenCleanup();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = withMocks;</span><br></pre></td></tr></table></figure>
<figure class="highlight javascript"><figcaption><span>with-mocks-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> withMocks = <span class="built_in">require</span>(<span class="string">'lib/withMocks'</span>);</span><br><span class="line"><span class="keyword">var</span> rewire = <span class="built_in">require</span>(<span class="string">'rewire'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> LatestArticleButton = rewire(<span class="string">'src/components/latest-article-button'</span>);</span><br><span class="line"></span><br><span class="line">describe(<span class="string">'The get latest article button'</span>, () =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> mockAjaxRequest = (url, callback) =&gt; callback(&#123;success: <span class="literal">true</span>, content: <span class="string">""</span>&#125;);</span><br><span class="line">  <span class="keyword">var</span> mockDatabase = &#123;select: (table, command) =&gt; [], createTable: () =&gt; <span class="literal">null</span>&#125;;</span><br><span class="line">  </span><br><span class="line">  it(<span class="string">'should render a sorry message if an article is returned successfully but is empty'</span>, () =&gt; &#123;</span><br><span class="line">    withMocks(LatestArticleButton, &#123;</span><br><span class="line">      ajaxRequest: mockAjaxRequest,</span><br><span class="line">      factsDatabase: mockDatabase</span><br><span class="line">    &#125;, () =&gt; &#123;</span><br><span class="line">      <span class="keyword">var</span> component = React.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">LatestArticleButton</span> /&gt;</span>)</span>;</span><br><span class="line">      TestUtils.Simulate.click(component.findDOMElement); <span class="comment">// will eventually make an ajaxRequest</span></span><br><span class="line">      waitFor(() =&gt; component.state.overlayMessage === <span class="string">'That article is no longer available'</span>, <span class="string">'The correct error was not displayed'</span>, done);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="Gotchas">Gotchas</h1><h2 id="You_Cannot_Check_State/Render_or_Simulate_Right_After_Simulating_an_Event">You Cannot Check State/Render or Simulate Right After Simulating an Event</h2><p>This will seem obvious if you’ve already gone through some of the scenarios. Consider the following test:<br><figure class="highlight javascript"><figcaption><span>gotcha-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should add the clicked account to the list of selected accounts'</span>, () =&gt; &#123;</span><br><span class="line">  accountSelector = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountSelector</span> <span class="attribute">accounts</span>=<span class="value">&#123;[...]&#125;</span> <span class="attribute">accountGroups</span>=<span class="value">&#123;[...]&#125;</span> /&gt;</span>)</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">1</span>]);</span><br><span class="line">  expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">1</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>This will fail, saying that accountSelector.state.selectedAccounts.length is 0, which it is.<br>When we clicked the account, we triggered a setState, which will in turn change the actual state, as well as re-render. However, both of these are not done synchronously - they are added to the next slot in the event loop.</p>
<p>This applies to sequences of simulations as well:<br><figure class="highlight javascript"><figcaption><span>gotcha-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should de-select any accounts when I select an account group'</span>, () =&gt; &#123;</span><br><span class="line">  accountSelector = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountSelector</span> <span class="attribute">accounts</span>=<span class="value">&#123;[...]&#125;</span> <span class="attribute">accountGroups</span>=<span class="value">&#123;[...]&#125;</span> /&gt;</span>)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">  <span class="keyword">var</span> accountGroup = TestUtils.findRenderedComponentWithType(accountSelector, AccountGroup);</span><br><span class="line">  </span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">1</span>]);</span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">2</span>]);</span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">4</span>]);</span><br><span class="line">  expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">3</span>);</span><br><span class="line">  TestUtils.Simulate.click(accountGroup);</span><br><span class="line">  expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>The operation of these simulations all depend on the state and DOM generated by the previous actions, and thus the result will not be what you expect.</p>
<p>The solution to both of these problems is to use the Then pattern, or the WaitFor pattern, along with manual termination of tests:<br><figure class="highlight javascript"><figcaption><span>gotcha-covered-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should add the clicked account to the list of selected accounts'</span>, (done) =&gt; &#123;</span><br><span class="line">  accountSelector = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountSelector</span> <span class="attribute">accounts</span>=<span class="value">&#123;[...]&#125;</span> <span class="attribute">accountGroups</span>=<span class="value">&#123;[...]&#125;</span> /&gt;</span>)</span>;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">var</span> accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">1</span>]);</span><br><span class="line">  then(() =&gt; &#123;</span><br><span class="line">    expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">1</span>);</span><br><span class="line">    done();</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">  <span class="comment">//OR</span></span><br><span class="line">  </span><br><span class="line">  waitFor(() =&gt; accountSelector.state.selectedAccounts.length === <span class="number">1</span>, <span class="string">'The selectedAccounts list was not updated after clicking an account'</span>, done);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>See the next Gotcha for an example of proper sequencing for Simulations.</p>
<h2 id="You_Cannot_Simulate_Events_in_Series_Without_Re-Finding_DOM_Components">You Cannot Simulate Events in Series Without Re-Finding DOM Components</h2><p>Consider the following test, where we already know we have to sequence our simulations:<br><figure class="highlight javascript"><figcaption><span>gotcha-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should de-select any accounts when I select an account group'</span>, (done) =&gt; &#123;</span><br><span class="line">  accountSelector = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountSelector</span> <span class="attribute">accounts</span>=<span class="value">&#123;[...]&#125;</span> <span class="attribute">accountGroups</span>=<span class="value">&#123;[...]&#125;</span> /&gt;</span>)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">  <span class="keyword">var</span> accountGroup = TestUtils.findRenderedComponentWithType(accountSelector, AccountGroup);</span><br><span class="line">  </span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">1</span>]);</span><br><span class="line">  then(() =&gt; &#123;</span><br><span class="line">    TestUtils.Simulate.click(accounts[<span class="number">2</span>]);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    TestUtils.Simulate.click(accounts[<span class="number">4</span>]);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">3</span>);</span><br><span class="line">    TestUtils.Simulate.click(accountGroup);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">0</span>);</span><br><span class="line">    done();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>If you run this, you’ll right away notice what’s wrong: it’ll fail with a cryptic error:<br><figure class="highlight nimrod"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Error</span>: <span class="type">Invariant</span> <span class="type">Violation</span>: <span class="type">Component</span> (<span class="keyword">with</span> keys: getDOMNode,props,context,state,refs,_reactInternalInstance) contains `render` <span class="keyword">method</span> but <span class="keyword">is</span> <span class="keyword">not</span> mounted <span class="keyword">in</span> the <span class="type">DOM</span></span><br></pre></td></tr></table></figure></p>
<p>This is occurring because you are Simulating an event on a DOM element that is no longer rendered. Via closure, the reference in accounts[2] is still a valid pointer, but it is no longer in the DOM, because clicking on the first button has changed the state, which in turned casues a re-render, replacing the old DOM nodes. After the re-render, we need to re-grab the DOM node that we want to click. </p>
<figure class="highlight javascript"><figcaption><span>gotcha-covered-spec.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should de-select any accounts when I select an account group'</span>, (done) =&gt; &#123;</span><br><span class="line">  accountSelector = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">AccountSelector</span> <span class="attribute">accounts</span>=<span class="value">&#123;[...]&#125;</span> <span class="attribute">accountGroups</span>=<span class="value">&#123;[...]&#125;</span> /&gt;</span>)</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> accounts;</span><br><span class="line">  </span><br><span class="line">  accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">  TestUtils.Simulate.click(accounts[<span class="number">1</span>]);</span><br><span class="line">  then(() =&gt; &#123;</span><br><span class="line">    accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">    TestUtils.Simulate.click(accounts[<span class="number">2</span>]);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    accounts = TestUtils.scryRenderedComponentsWithType(accountSelector, Account);</span><br><span class="line">    TestUtils.Simulate.click(accounts[<span class="number">4</span>]);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> accountGroup = TestUtils.findRenderedComponentWithType(accountSelector, AccountGroup);</span><br><span class="line">    TestUtils.Simulate.click(accountGroup);</span><br><span class="line">  &#125;).then(() =&gt; &#123;</span><br><span class="line">    expect(accountSelector.state.selectedAccounts.length).toBe(<span class="number">0</span>);</span><br><span class="line">    done();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h2 id="TestUtils-mockComponent_wont_create_basic_mocks">TestUtils.mockComponent wont create basic mocks</h2><p><a href="https://facebook.github.io/react/docs/test-utils.html#mockcomponent" target="_blank" rel="external">According to the React TestUtils Docs</a>, you can use TestUtils.mockComponent() to create a quick mock that simply renders an empty div. However, what is not documented is that this feature is only available if you are using Jest.</p>
<p>The intended use case is:<br><figure class="highlight javascript"><figcaption><span>jest.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">TestUtils.mockComponent(jest.genMockFunction());</span><br></pre></td></tr></table></figure></p>
<p>If you do need a basic dummy component, you can simply create a shared inline mock component:<br><figure class="highlight javascript"><figcaption><span>basic-mock.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MockedSubComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="title">div</span>&gt;</span><span class="tag">&lt;/<span class="title">div</span>&gt;</span>;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="Expectations_won’t_print_inside_asynchronous_tests">Expectations won’t print inside asynchronous tests</h2><p>For a regular test, you utilize <em>expect</em> to ensure your conditions are met, and depend on its output to tell you where and why something failed. However, within an asynchronous test, this output will not come out, and instead your test will block for some time (default 5 seconds) and then fail with a generic Async timeout failure.</p>
<p>The solution to this is to simply manually call fail.<br><figure class="highlight javascript"><figcaption><span>async-failure-integration-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">it(<span class="string">'should update the account name if its empty and we refresh it'</span>, (done) =&gt; &#123;</span><br><span class="line">  <span class="keyword">var</span> accountDisplay = TestUtils.renderIntoDocument(AccountDisplay);</span><br><span class="line">  TestUtils.Simulate.click(React.findDOMNode(accountDisplay.refs.refreshButton));</span><br><span class="line">  </span><br><span class="line">  <span class="comment">// We should use the WaitFor pattern here, but I'll show it without it to illustrate the manual failure</span></span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    <span class="comment">// if we call expect here and it fails, we won't get the right error message, but instead an async timeout message</span></span><br><span class="line">    <span class="keyword">if</span> (accountDisplay.state.accountName !== <span class="string">'Test Account 1234'</span>) &#123;</span><br><span class="line">      fail(<span class="string">'The account name was not updated after refreshing the display and waiting 2 seconds. Found: '</span> + accountDisplay.state.accountName);</span><br><span class="line">    &#125;</span><br><span class="line">    done(); <span class="comment">// the done call ensures our test does not timeout, nor waste any extra time. It is called even if fail was called</span></span><br><span class="line">  &#125;, <span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>This is also how the WaitFor pattern works.</p>
<h2 id="Mocked_dependencies_must_be_searched_for_my_their_mock_class">Mocked dependencies must be searched for my their mock class</h2><p>Mocking with rewire in javascript does not provide full polymorphism - if you override a mock class my name, any reference to the original will now be a mock component, but the <em>type</em> of the new components will be MockComponent.</p>
<p>This means you have to search for sub-components by their mock classes name, rather than their original name:<br><figure class="highlight javascript"><figcaption><span>my-component-mocked-spec.jsx</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MockAvatar</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render () &#123;...&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">it(<span class="string">'should be rendered with an Avatar as a child'</span>, () =&gt; &#123;</span><br><span class="line">  withMocks(Profile, &#123;</span><br><span class="line">    Avatar: MockAvatar</span><br><span class="line">  &#125;, () =&gt; &#123;</span><br><span class="line">    profile = TestUtils.renderIntoDocument(<span class="xml"><span class="tag">&lt;<span class="title">Profile</span> /&gt;</span>)</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Wrong</span></span><br><span class="line">    <span class="keyword">var</span> child = ReactTestUtils.findRenderedComponentWithType(profile, Avatar);</span><br><span class="line">    expect(ReactTestUtils.isCompositeComponentWithType(child, Avatar)).toBe(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Right</span></span><br><span class="line">    <span class="keyword">var</span> child = ReactTestUtils.findRenderedComponentWithType(profile, MockAvatar);</span><br><span class="line">    expect(ReactTestUtils.isCompositeComponentWithType(child, MockAvatar)).toBe(<span class="literal">true</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>This does not change how your component has to use the mocked component - it’s just a technicality you have to watch out for from outside of the component.</p>

        
        
            
        
    </div>
    <div class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/coverage/">coverage</a> <a class="tag tag--primary tag--small t-link" href="/tags/jasmine/">jasmine</a> <a class="tag tag--primary tag--small t-link" href="/tags/javascript/">javascript</a> <a class="tag tag--primary tag--small t-link" href="/tags/karma/">karma</a> <a class="tag tag--primary tag--small t-link" href="/tags/mocking/">mocking</a> <a class="tag tag--primary tag--small t-link" href="/tags/react/">react</a> <a class="tag tag--primary tag--small t-link" href="/tags/rewire/">rewire</a> <a class="tag tag--primary tag--small t-link" href="/tags/testing/">testing</a> <a class="tag tag--primary tag--small t-link" href="/tags/unittest/">unittest</a>

            </div>
        
        <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/02/16/Scaling-with-Docker-Part-1/"  data-tooltip="Scaling with Docker Part 1">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2014/07/21/PHPMessageScheduler/" data-tooltip="Building a Distributed Message Scheduler in PHP">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>
        
            <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2016 Brandon Okert. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="1">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2016/02/16/Scaling-with-Docker-Part-1/"  data-tooltip="Scaling with Docker Part 1">
                
                    <i class="fa fa-angle-left"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    <a class="post-action-btn btn btn--default tooltip--top" href="/2014/07/21/PHPMessageScheduler/" data-tooltip="Building a Distributed Message Scheduler in PHP">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions"  href="#btn-open-shareoptions">
                <i class="fa fa-share-alt"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://plus.google.com/share?url=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-google-plus"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-facebook-official"></i>
            </a>
        </li>
        <li class="post-action hide-xs">
            <a class="post-action-btn btn btn--default" target="new" href="https://twitter.com/intent/tweet?text=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-twitter"></i>
            </a>
        </li>
        
            <li class="post-action">
                <a class="post-action-btn btn btn--default" href="#disqus_thread">
                    <i class="fa fa-comment-o"></i>
                </a>
            </li>
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#">
            
                <i class="fa fa-list"></i>
            </a>
        </li>
    </ul>
</div>
                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="1">
    <ul class="share-options">
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://plus.google.com/share?url=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-google-plus"></i><span class="">Share on Google Plus</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://www.facebook.com/sharer/sharer.php?u=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-facebook-official"></i><span>Share on Facebook</span>
            </a>
        </li>
        <li class="share-option">
            <a class="share-option-btn" target="new" href="https://twitter.com/intent/tweet?text=http://brandonokert.com/2015/08/04/TestingInReact/">
                <i class="fa fa-twitter"></i><span>Share on Twitter</span>
            </a>
        </li>
    </ul>
</div>
<div id="share-options-mask" class="share-options-mask"></div>
            
        </div>
        <div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="http://www.gravatar.com/avatar/1796d3ceead403d9616a2093bc42ec18?s=110"/>
        
            <h4 id="about-card-name">Brandon Okert</h4>
        
            <h5 id="about-card-bio"><p>Husband, Software Engineer, Web Developer, Coffee Geek, Chess Dabbler, Runner, Strategy Gamer, Dog Owner, Cat Lover.<br><img src="/img/about/about-me-profile.jpg" alt=""> <img src="/img/about/sarah3.png" alt=""> <img src="/img/about/storm-n-me.jpg" alt=""> <img src="/img/about/storm-giving-a-speech.jpg" alt=""><br><img src="/img/about/brandonsarah1.jpg" alt=""> <img src="/img/about/brandonsarah2.jpg" alt=""> <img src="/img/about/sarah1.jpg" alt=""> <img src="/img/about/sarah2.jpg" alt=""></p>
</h5>
        
        
            <h5 id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>Hootsuite Media Inc.</p>

            </h5>
        
        
            <h5 id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Vancouver, BC
            </h5>
        
    </div>
</div>
        <div id="cover" style="background-image:url('/assets/images/covercloud.png');"></div>
    </body>
    <!--SCRIPTS-->
<script src="/assets/js/script.min.js" type="text/javascript"></script>
<script src="/js-custom/sequenced-image.js" type="text/javascript"></script>
<!--SCRIPTS END-->

    <script type="text/javascript">
        var disqus_shortname = 'brandonokert';
        (function() {
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>



</html>
